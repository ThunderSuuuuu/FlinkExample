package com.sulei.test.udf;

import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.node.ObjectNode;
import org.apache.flink.table.functions.ScalarFunction;
import com.fasterxml.jackson.databind.ObjectMapper;

import java.io.IOException;
import java.util.List;

/**
 * @author sulei
 * @date 2020/7/22
 * @e-mail 776531804@qq.com
 *
 * 特殊需求：流进来的数据中的某些字段，用来当做调用某个http接口时传入的参数。
 * 这里，rest接口url固定，调rest接口时的方式固定（POST），调用接口时传的参格式固定（json的格式），而json中某个字段的值需要从流进来的数据中某个字段取。
 * 而调用接口的返回值（json），将返回值中某个字段取出来，当做一个新字段拼接到流进来的数据后。这个字段可能是一个数组中多次出现的值，需要用分隔符分开
 */

public class HttpUdf extends ScalarFunction {
    private String url;
    private ObjectMapper mapper;
//    private HttpRestfulClient httpClient;
    private JsonNode requestObject = null;

    public HttpUdf() {
        initHttpHandler();
        initJsonHandler();
    }

    public HttpUdf(String url) {
        this();
        this.url = url;
    }

    private void initHttpHandler() {
//        httpClient = new HttpRestfulClient(url);
    }

    private void initJsonHandler() {
        mapper = new ObjectMapper();
    }

    /**
     * 每条数据应用的udf
     *
     * @param originColumn    原始数据中作为调用http接口所需要的内容的字段名
     * @param requestBody     http接口带的body，json格式
     * @param jsonColumnName  http接口返回值（json）中所需要的字段名
     * @param columnSeparator http接口返回值中所需要的字段可能包含在数组中，所以可能会出现多个，当是多个时的分隔符
     */
    public String eval(String originColumn, String requestBody, String jsonColumnName, String columnSeparator) throws Exception {
        JsonNode requestObject = getRequestObject(requestBody);
        ((ObjectNode) requestObject.get("params")).put("userMobile", originColumn);

        String resultString = "{\"rtnCode\":\"0\",\"rtnMsg\":\"成功!\",\"bean\":{},\"beans\":[],\"object\":{\"respCode\":\"0\",\"respDesc\":\"success\",\"result\":{\"userId\":\"16510064581885\",\"offerList\":[{\"offerPrice\":\"0/月\",\"status\":\"2\",\"canUnsub\":\"0\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20190818175652\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20190818175639\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"OFFER|ZFK\",\"offerName\":\"套餐主副卡\",\"offerId\":\"100165000528\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"其他产品\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"OFFER|ZFK\",\"orderDep\":\"\",\"offerDesc\":\"套餐主副卡\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"9800/月\",\"status\":\"\",\"canUnsub\":\"1\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20171109162710\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20171109162710\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"PIXYDBJL98A\",\"offerName\":\"移动冰激凌-98元A套餐\",\"offerId\":\"100168000824\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"主资费\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"PIXYDBJL98A\",\"orderDep\":\"\",\"offerDesc\":\"1、月套餐费98元，含国内流量达量限速和1000分钟国内主叫国内通话，免费赠送来电显示，在国内接听电话免费；2、超过套餐包含通话时长后：直接拨打国内电话0.19元/分钟。3、国内流量超过40G后，国内流量网速限速，限速后网速不高于1Mbps，国内流量不收取费用；当月全部流量使用达到200GB后，限速至128kbps，次月自动恢复。4、短信费：发送国内短信0.1元/条；接收免费（不含梦网信息）。5、以上内容不含港澳台地区资费。\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"1\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"0\",\"canUnsub\":\"0\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20171109162710\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20171109162710\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"TD_VPHONE\",\"offerName\":\"可视电话包\",\"offerId\":\"100111000202\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"基础功能\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"TD_VPHONE\",\"orderDep\":\"\",\"offerDesc\":\"可视电话包\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"0\",\"canUnsub\":\"0\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20171109162710\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20171109162710\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"BPA83\",\"offerName\":\"国内漫游\",\"offerId\":\"108000000160\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"基础功能\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"BPA83\",\"orderDep\":\"\",\"offerDesc\":\"国内漫游\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"0\",\"canUnsub\":\"0\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20171109162710\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20171109162710\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"SRVC|LLB\",\"offerName\":\"流量服务包\",\"offerId\":\"420001648949\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"基础功能\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"SRVC|LLB\",\"orderDep\":\"\",\"offerDesc\":\"\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"0\",\"canUnsub\":\"0\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20171109162710\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20171109162710\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"SRVC|SJSWGN\",\"offerName\":\"手机上网功能服务包（包含2 3 4G）\",\"offerId\":\"108005001080\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"基础功能\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"SRVC|SJSWGN\",\"orderDep\":\"\",\"offerDesc\":\"\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"0\",\"canUnsub\":\"0\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20171109162710\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20171109162710\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"BPA81\",\"offerName\":\"语音\",\"offerId\":\"108000000158\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"基础功能\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"BPA81\",\"orderDep\":\"\",\"offerDesc\":\"全球通语音\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"0\",\"canUnsub\":\"1\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20171109162710\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20171109162710\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"BPA11\",\"offerName\":\"主叫号码显示\",\"offerId\":\"108000000013\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"基础功能\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"BPA11\",\"orderDep\":\"\",\"offerDesc\":\"主叫号码显示\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"0\",\"canUnsub\":\"0\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20171109162710\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20171109162710\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"BPA82\",\"offerName\":\"国内长途\",\"offerId\":\"108000000159\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"基础功能\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"BPA82\",\"orderDep\":\"\",\"offerDesc\":\"国内长途\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"0\",\"canUnsub\":\"1\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20171109162710\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20171109162710\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"BPA9\",\"offerName\":\"呼叫保持\",\"offerId\":\"108000000167\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"基础功能\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"BPA9\",\"orderDep\":\"\",\"offerDesc\":\"呼叫保持\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"0\",\"canUnsub\":\"0\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20200303174232\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20200303174232\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20200831235959\",\"bossId\":\"SRVC|SJSWGN\",\"offerName\":\"手机上网功能服务包（包含2 3 4G）\",\"offerId\":\"108005001080\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"基础功能\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"SRVC|SJSWGN\",\"orderDep\":\"\",\"offerDesc\":\"\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"0\",\"canUnsub\":\"1\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20171109162710\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20171109162710\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"BPA8\",\"offerName\":\"呼叫等待\",\"offerId\":\"108000000156\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"基础功能\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"BPA8\",\"orderDep\":\"\",\"offerDesc\":\"呼叫等待\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"0\",\"canUnsub\":\"1\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20171109162710\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20171109162710\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"BPA2\",\"offerName\":\"短消息服务\",\"offerId\":\"108000000054\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"基础功能\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"BPA2\",\"orderDep\":\"\",\"offerDesc\":\"短消息服务\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"0\",\"canUnsub\":\"0\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20200209060928\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20200209060928\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"SRVC|SJSWGN\",\"offerName\":\"手机上网功能服务包（包含2 3 4G）\",\"offerId\":\"108005001080\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"基础功能\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"SRVC|SJSWGN\",\"orderDep\":\"\",\"offerDesc\":\"\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"0\",\"canUnsub\":\"0\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20200303174232\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20200303174232\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20200831235959\",\"bossId\":\"PIX19LLKRB2\",\"offerName\":\"10G流量扩容包-6个月\",\"offerId\":\"100168003075\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"自有业务\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"PIX19LLKRB2\",\"orderDep\":\"\",\"offerDesc\":\"10G流量扩容包-6个月产品，1、月费0元，订购期间，每个月享受10G国内流量（2/3/4/5G通用、不含港澳台）；2、该产品订购立即生效，每月自动续订，连续订购6个自然月（包含订购当月），产品到期自动取消；3、该产品内当月国内流量不可结转，不可共享。合约期内需承诺在网并履行约定，如申请停机保号、销号、携号转网等服务请至当地移动自营厅解约后办理，解除合约按河南移动合约活动提前解约方案执行\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"40000/月\",\"status\":\"0\",\"canUnsub\":\"0\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20191009094111\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20191009094111\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"PIXSJKDP\",\"offerName\":\"手机宽带500M套餐\",\"offerId\":\"100168000882\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"自有业务\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"PIXSJKDP\",\"orderDep\":\"\",\"offerDesc\":\"资费400元/月，需使用当前手机号码作为有线宽带的登录账号，宽带最高上行速率按网络侧实际配置执行。\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"0\",\"canUnsub\":\"1\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20190201102904\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20190201102904\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"PIXVOLTE\",\"offerName\":\"VoLTE语音\",\"offerId\":\"100165000549\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"自有业务\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"PIXVOLTE\",\"orderDep\":\"\",\"offerDesc\":\"VoLTE语音\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"0\",\"canUnsub\":\"0\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20131018000000\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20131018000000\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"PIXGPRSZTX\",\"offerName\":\"数据流量周提醒服务（免费）\",\"offerId\":\"100163000403\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"自有业务\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"PIXGPRSZTX\",\"orderDep\":\"\",\"offerDesc\":\"数据流量周提醒服务（免费）\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"1000/月\",\"status\":\"0\",\"canUnsub\":\"0\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20180422153138\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20180422153139\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"PIXMBHYHB1\",\"offerName\":\"魔百和高清电视（银河B版）\",\"offerId\":\"100168000434\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"自有业务\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"PIXMBHYHB1\",\"orderDep\":\"\",\"offerDesc\":\"魔百和高清电视基础包月功能费：必须订购的基础功能包，10元/月/终端。包含基本的标清及高清节目，用户订购该基础包后，收看所提供的免费基本节目不再额外收取费用。\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"0\",\"canUnsub\":\"1\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20200209060928\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20200209060928\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"PIXHFADD\",\"offerName\":\"长期提速功能\",\"offerId\":\"100168002761\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"自有业务\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"PIXHFADD\",\"orderDep\":\"\",\"offerDesc\":\"阶梯定价恢复网速叠加包，限速后可按正常速率访问网络，每月首次限速后使用流量先按第一个阶梯5元1GB收费，当月累计使用3GB后，开始按第二个阶梯3元1GB收费，之后一直按照3元1GB收费，不用不收费；每1GB流量费用一次性收取，流量一次性提供,仅限当月使用；该产品长期有效，每月首次限速后均按第一个阶梯定价开始收费。\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"0\",\"canUnsub\":\"0\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20191009094105\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20191009094059\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"PIXKDDSYJB4\",\"offerName\":\"500M宽带电视优惠包-优家套餐2019B版\",\"offerId\":\"100168002456\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"自有业务\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"PIXKDDSYJB4\",\"orderDep\":\"\",\"offerDesc\":\"500M宽带电视优惠包-优家套餐2019B版\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"0\",\"canUnsub\":\"0\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20191009094105\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20191009094059\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"PIXKDDSYJB4\",\"offerName\":\"500M宽带电视优惠包-优家套餐2019B版\",\"offerId\":\"100168002456\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"自有业务\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"PIXKDDSYJB4\",\"orderDep\":\"\",\"offerDesc\":\"500M宽带电视优惠包-优家套餐2019B版\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"0\",\"canUnsub\":\"0\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20180523160316\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20180523160316\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"X00262002\",\"offerName\":\"50元话费直充\",\"offerId\":\"420001070109\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"营销活动\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"X00262002\",\"orderDep\":\"\",\"offerDesc\":\"50元话费直充\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"0\",\"canUnsub\":\"0\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20180422153138\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20180422153139\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20260722153138\",\"bossId\":\"X14201709033001\",\"offerName\":\"用户缴纳0元押金使用光猫一台（控制办理量）-装维携带\",\"offerId\":\"600000290429\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"营销活动\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"X14201709033001\",\"orderDep\":\"\",\"offerDesc\":\"收取0元作为押金使用光猫一台，控制办理量。退订业务时应退还设备，且不退还该笔费用；不能退还设备的，应缴纳赔偿金。合约期2年，合约期内承诺在网，不可办理携号转网；如提前终止活动，需按河南移动合约活动提前解约方案执行。\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"0\",\"canUnsub\":\"0\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20180422153138\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20180422153139\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20260722153138\",\"bossId\":\"X14201709030001\",\"offerName\":\"缴纳0元押金使用高清电视机顶盒一台（控制办理量）-装维携带\",\"offerId\":\"600000290431\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"营销活动\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"X14201709030001\",\"orderDep\":\"\",\"offerDesc\":\"\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"0\",\"canUnsub\":\"0\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20170927163749\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20170927163750\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"X16201708025002\",\"offerName\":\"4G客户语音扩容-100分钟\",\"offerId\":\"600000282125\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"营销活动\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"X16201708025002\",\"orderDep\":\"\",\"offerDesc\":\"\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"0\",\"canUnsub\":\"0\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20150825200615\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20150825200615\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"X00262001\",\"offerName\":\"30元话费直充\",\"offerId\":\"420001070108\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"营销活动\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"X00262001\",\"orderDep\":\"\",\"offerDesc\":\"30元话费直充\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"0\",\"canUnsub\":\"0\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20141029101024\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20141029101024\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"A1120141001001\",\"offerName\":\"4G单模流量体验业务\",\"offerId\":\"420002127879\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"营销活动\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"A1120141001001\",\"orderDep\":\"\",\"offerDesc\":\"4G单模流量体验活动含每月1G4G单模上网流量，连送3个月，客户参与当月立即生效，仅可在4G网络下使用。\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"0\",\"canUnsub\":\"0\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20120429141726\",\"bindActName\":\"\",\"billType\":\"\",\"offerSts\":\"正常\",\"orderTime\":\"20120429141725\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"A1120120130001\",\"offerName\":\"郑州轻松卡C入网带4号50含100\",\"offerId\":\"420001162387\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"营销活动\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"A1120120130001\",\"orderDep\":\"\",\"offerDesc\":\"郑州轻松卡C入网带4号50含100\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"},{\"offerPrice\":\"0/月\",\"status\":\"1\",\"canUnsub\":\"1\",\"voiceLongDistanceAjust\":\"\",\"effTime\":\"20140808000000\",\"bindActName\":\"\",\"billType\":\"包月计费\",\"offerSts\":\"正常\",\"orderTime\":\"20140808000000\",\"upOfferName\":\"\",\"flowLongDistanceAjust\":\"\",\"expTime\":\"20991231235959\",\"bossId\":\"和彩云\",\"offerName\":\"和彩云\",\"offerId\":\"410000190431\",\"operModuleCode\":\"\",\"flowBusiType\":\"\",\"spName\":\"中国移动-彩云\",\"shortNum\":\"\",\"servAreaName\":\"\",\"upOfferId\":\"\",\"chooseTag\":\"\",\"orderChnn\":\"\",\"operModuleName\":\"\",\"brandId\":\"\",\"spCode\":\"698027\",\"orderStaffid\":\"\",\"bindActId\":\"\",\"operArea\":\"\",\"offerAttrList\":[],\"bizCode\":\"YDCY\",\"instructions\":\"\",\"priority\":\"\",\"lastOrderStaff\":\"\",\"isRemoved\":\"\",\"lastOrderChnn\":\"\",\"offerType\":\"\",\"offerTypeName\":\"梦网业务\",\"isPackage\":\"0\",\"brandName\":\"\",\"prodInstId\":\"16510064581885\",\"servType\":\"\",\"remark\":\"和彩云\",\"orderDep\":\"\",\"offerDesc\":\"\",\"lastOrderTime\":\"\",\"bindActEndTime\":\"\",\"isMain\":\"0\",\"offerPriceDesc\":\"\",\"isLog\":\"0\",\"logUrl\":\"\",\"startOrderTime\":\"\",\"closeOrderTime\":\"\",\"bizName\":\"\",\"messagePort\":\"\",\"spType\":\"0\",\"isRelevanceOffer\":\"0\",\"isSonOffer\":\"0\"}]},\"resultRows\":\"30\"}}";
        JsonNode resultNode = mapper.readTree(resultString);
        List<JsonNode> nodes = resultNode.findValues(jsonColumnName);

        StringBuilder sb = new StringBuilder();
        for (JsonNode node : nodes) {
            sb.append(node.asText()).append(columnSeparator);
        }

        return sb.toString();
    }

    public String eval(String originColumn, String requestBody, String jsonColumnName) throws Exception {
        return eval(originColumn, requestBody, jsonColumnName, "@@");
    }

    private JsonNode getRequestObject(String requestBody) throws IOException {
        if (requestObject == null) {
            synchronized (this) {
                if (requestObject == null) {
                    requestObject = mapper.readTree(requestBody);
                }
            }
        }
        return requestObject;
    }
}
